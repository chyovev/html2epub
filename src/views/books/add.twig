<div class="breadcrumbs-wrapper">
    {{ include('elements/breadcrumb.twig') }}
</div>

<form method="post" class="ajax-form">

    {% include 'elements/flash.message.twig' %}

    <div class="row">
        <div class="col-lg-5 ml-lg-5 toc-wrapper">
            <div id="toc" class="p-lg-4">
                <div class="mb-4 h4 font-weight-bold">
                    <!-- <button class="btn btn-sm btn-light align-middle add" id="add_chapter" title="Add new element">&nbsp;</button> -->
                    <span class="align-middle toc-title d-inline-block d-lg-none">Add chapter</span>
                    <span class="align-middle toc-title d-none d-lg-inline-block">Table of Contents</span>
                </div>

                <div class="form-group">
                    <ol class="dd-list">
                        <li class="dd-item">
                            <div class="dd-handle static {% if book.id and toc and not chapter %} active{% endif %}">
                                <span class="title">
                                    {% if book.id and toc %}
                                        <a href="{{ custom_url('generateBookUrl', book.slug)}}">Book details</a>
                                    {% else %}
                                        Book details
                                    {% endif %}
                                </span>
                            </div>
                        </li>
                    </ol>

                    {% if _action == 'add' %}
                        <p class="p-4 mt-4 form-control-plaintext text-center">To add new chapters, you have to save the first book.</p>
                    {% endif %}

                    {% if toc %}

                        <div class="dd" href="{{ custom_url('generateTocUrl', book.slug)}}">
                            {{ include('elements/chapters.twig', {chapters: toc, level: 0}) }}
                        </div>

                    {% endif %}
                </div>
            </div>
            <div id="toc-toggler" class="d-block d-lg-none">Table of Contents</div>
        </div>

        <div class="col col-lg-6 ml-lg-4 pb-lg-5 pr-lg-5" id="content">
            {% if not chapter %}
                {{ include('books/book-details.twig') }}
            {% else %}
                {{ include('books/chapter-details.twig') }}
            {% endif %}
        </div>
    </div>
</form>