{% if not book['id'] %}
    {% set breadcrumbs = [['Books', custom_url('generateBooksIndexUrl')], ['Add new book', NULL], book.title] %}
{% else %}
    {% set breadcrumbs = [['Books', custom_url('generateBooksIndexUrl')], [book.title, NULL], 'Edit'] %}
{% endif %}

{{ include('elements/breadcrumb.twig', {'breadcrumbs': breadcrumbs}) }}

<form method="post">

    {% include 'elements/flash.message.twig' %}

    <div class="row">
        <div class="col-lg-4 offset-lg-1">
            <div class="mb-4 h4 font-weight-bold">
                <span class="align-middle">Table of Contents</span>
            </div>

            <div class="form-group">
                <ol class="dd-list">
                    <li class="dd-item">
                        <div class="dd-handle static">
                            <span class="title">Book details</span>
                        </div>
                    </li>
                </ol>

                {% if chapters %}

                    <div class="dd">
                        {{ include('elements/chapters.twig', {level: 0}) }}
                    </div>

                {% endif %}
            </div>
        </div>

        <div class="col col-lg-5 offset-lg-1">
            <div class="mb-4 h4 font-weight-bold">
                <span class="align-middle">Book details</span>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="title">Title</label>
                    <input type="text" name="title" id="title" placeholder="*Title" value="{{ book['title']|e }}" class="form-control{% if errors['title'] %} is-invalid{% endif %}" />
                    {% if errors['title'] %}<span class="invalid-feedback">{{ errors['title'][0] }}</span>{% endif %}
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="subtitle">Subtitle</label>
                    <input type="text" name="subtitle" id="subtitle" placeholder="Subtitle (optional)" value="{{ book['subtitle']|e }}" class="form-control{% if errors['subtitle'] %} is-invalid{% endif %}" />
                    {% if errors['subtitle'] %}<span class="invalid-feedback">{{ errors['subtitle'][0] }}</span>{% endif %}
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="slug">Slug</label>
                    <input type="text" name="slug" id="slug" placeholder="*Slug" value="{{ book['slug']|e }}" class="form-control{% if errors['slug'] %} is-invalid{% endif %}" />
                    {% if errors['slug'] %}<span class="invalid-feedback">{{ errors['slug'][0] }}</span>{% endif %}
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="author">Author(s)</label>
                    <input type="text" name="author" id="author" placeholder="Author(s) (optional)" value="{{ book['author']|e }}" class="form-control{% if errors['author'] %} is-invalid{% endif %}" />
                    {% if errors['author'] %}<span class="invalid-feedback">{{ errors['author'][0] }}</span>{% endif %}
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="language_id">Language</label>
                    <select name="language_id" id="language_id" class="form-control{% if errors['language_id'] %} is-invalid{% endif %}">
                        <option value="">*Language</option>
                        {% for lang in languages %}
                        <option value="{{ lang.getId() }}"{% if book['language_id'] == lang.getId() %} selected="selected"{% endif %}>{{ lang.getLanguage()|escape }}</option>
                        {% endfor %}
                    </select>
                    {% if errors['language_id'] %}<span class="invalid-feedback">{{ errors['language_id'][0] }}</span>{% endif %}
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="publisher">Publisher</label>
                    <input type="text" name="publisher" id="publisher" placeholder="Publisher (optional)" value="{{ book['publisher']|e }}" class="form-control{% if errors['publisher'] %} is-invalid{% endif %}" />
                    {% if errors['publisher'] %}<span class="invalid-feedback">{{ errors['publisher'][0] }}</span>{% endif %}
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="year">Publishing year</label>
                    <input type="text" name="year" id="year" placeholder="Year (optional)" value="{% if book['year'] != 0 %}{{ book['year']|e }}{% endif %}" class="form-control{% if errors['year'] %} is-invalid{% endif %}" />
                    {% if errors['year'] %}<span class="invalid-feedback">{{ errors['year'][0] }}</span>{% endif %}
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="isbn">ISBN</label>
                    <input type="text" name="isbn" id="isbn" placeholder="ISBN (optional)" value="{{ book['isbn']|e }}" class="form-control{% if errors['isbn'] %} is-invalid{% endif %}" />
                    {% if errors['isbn'] %}<span class="invalid-feedback">{{ errors['isbn'][0] }}</span>{% endif %}
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-12">
                    <label class="form-control-label" for="extra_info">Extra information</label>
                    <textarea name="extra_info" id="extra_info" placeholder="Extra information (optional)" class="form-control{% if errors['extra_info'] %} is-invalid{% endif %}">{{ book['extra_info']|e }}</textarea>
                    {% if errors['extra_info'] %}<span class="invalid-feedback">{{ errors['extra_info'][0] }}</span>{% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="form-group row text-center mt-5">
        <div class="col-lg-12">
            <input type="submit" class="btn btn-outline-info" value="{% if book['id'] %}Save{% else %}Add{% endif %} book" />
        </div>
    </div>
</form>